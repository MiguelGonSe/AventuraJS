<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Modules/Ranking.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Modules/Ranking.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { groupBy } from "../Utils/Utils.js";

/**
 * Simula un combate por turnos entre el jugador y un enemigo est치ndar.
 * Calcula el da침o bas치ndose en ataque y defensa, actualiza la vida y genera un reporte HTML.
 *
 * NOTA: Esta funci칩n muta el estado del jugador (puntos y vida) si gana.
 *
 * @param {Personaje} jugador - La instancia del personaje principal.
 * @param {Enemigo} enemigo - El enemigo contra el que se combate.
 * @returns {string} C칩digo HTML que describe ronda por ronda lo sucedido en la batalla.
 */

export function batalla(jugador, enemigo) {
    let vidaJugador = jugador.vidaTotal ?? jugador.vida;
    let vidaEnemigo = enemigo.vida;

    const danioJugador = jugador.ataqueTotal ?? jugador.ataque;
    const danioEnemigo = enemigo.ataque;

    let ronda = 1;
    let resultadoHTML = `&lt;h3>丘덢잺 ${jugador.nombre} vs ${enemigo.nombre}&lt;/h3>`;

    while (vidaJugador > 0 &amp;&amp; vidaEnemigo > 0) {
        const danioRealJugador = Math.max(1, danioJugador - (enemigo.defensa ?? 0) / 2);
        const danioRealEnemigo = Math.max(1, danioEnemigo - (jugador.defensaTotal ?? jugador.defensa) / 2);

        resultadoHTML += `
          &lt;div class="ronda">
            &lt;strong>游뽖 Ronda ${ronda}&lt;/strong>&lt;br>
            &lt;span class="ataque_jugador">${jugador.nombre} inflige ${danioRealJugador} de da침o a ${enemigo.nombre}.&lt;/span>&lt;br>
        `;

        vidaEnemigo -= danioRealJugador;

        if (vidaEnemigo &lt;= 0) {
            vidaEnemigo = 0;
            resultadoHTML += `&lt;span>${enemigo.nombre} ha ca칤do.&lt;/span>&lt;/div>`;
            break;
        }

        resultadoHTML += `&lt;span class="ataque_enemigo">${enemigo.nombre} inflige ${danioRealEnemigo} de da침o a ${jugador.nombre}.&lt;/span>&lt;/div>`;
        vidaJugador -= danioRealEnemigo;
        ronda++;
    }

    if (vidaEnemigo &lt;= 0) {
        const puntosGanados = 100 + enemigo.ataque;
        jugador.puntos += puntosGanados;
        jugador.vida = vidaJugador + 100;
        resultadoHTML += `&lt;h4>游끥 ${jugador.nombre} ha ganado (${puntosGanados} pts y +100 vida)&lt;/h4>`;
    } else {
        resultadoHTML += `&lt;h4>游 ${enemigo.nombre} ha ganado. 춰Has perdido!&lt;/h4>`;
    }

    return resultadoHTML;
}
/**
 * Simula el combate final contra un Jefe.
 * Funciona de manera similar a `batalla` pero incluye l칩gica de fin de juego y multiplicadores de puntuaci칩n especiales.
 *
 * @param {Personaje} jugador - El personaje del jugador.
 * @param {Jefe} jefe - La instancia del Jefe (debe tener propiedades especiales como multiplicador).
 * @returns {string} C칩digo HTML con el resumen del combate final.
 */

export function batallaJefe(jugador, jefe) {
    let vidaJugador = jugador.vidaTotal ?? jugador.vida;
    let vidaJefe = jefe.vida;

    const danioJugador = jugador.ataqueTotal ?? jugador.ataque;
    const danioJefe = jefe.ataque;

    let ronda = 1;
    let resultadoHTML = `&lt;h3>丘덢잺 ${jugador.nombre} vs ${jefe.nombre}&lt;/h3>`;

    while (vidaJugador > 0 &amp;&amp; vidaJefe > 0) {
        const danioRealJugador = Math.max(1, danioJugador - (jefe.defensa ?? 0) / 2);
        const danioRealJefe = Math.max(1, danioJefe - (jugador.defensaTotal ?? jugador.defensa) / 2);

        resultadoHTML += `
          &lt;div class="ronda">
            &lt;strong>游뽖 Ronda ${ronda}&lt;/strong>&lt;br>
            &lt;span class="ataque_jugador">${jugador.nombre} inflige ${danioRealJugador} de da침o a ${jefe.nombre}.&lt;/span>&lt;br>
        `;

        vidaJefe -= danioRealJugador;

        if (vidaJefe &lt;= 0) {
            vidaJefe = 0;
            resultadoHTML += `&lt;span>${jefe.nombre} ha ca칤do.&lt;/span>&lt;/div>`;
            break;
        }

        resultadoHTML += `&lt;span class="ataque_enemigo">${jefe.nombre} inflige ${danioRealJefe} de da침o a ${jugador.nombre}.&lt;/span>&lt;/div>`;
        vidaJugador -= danioRealJefe;
        ronda++;
    }

    if (vidaJefe &lt;= 0) {
        const puntosGanados = (100 + jefe.ataque) * (jefe.multiplicador ?? 1);
        jugador.puntos += puntosGanados;
        resultadoHTML += `&lt;h4>游끥 ${jugador.nombre} ha ganado el juego (${puntosGanados} pts), ENHORABUENA&lt;/h4>`;
    } else {
        resultadoHTML += `&lt;h4>游 ${jefe.nombre} ha ganado. 춰Has perdido!&lt;/h4>`;
    }

    return resultadoHTML;
}

/**
 * Renderiza el ranking final en el DOM y lanza efectos visuales (confetti) seg칰n el desempe침o.
 * Manipula directamente el elemento con ID 'ranking_final'.
 *
 * @param {Personaje} jugador - El objeto jugador con la puntuaci칩n final acumulada.
 * @returns {void} No retorna valor, modifica el DOM directamente.
 */

export function mostrarRanking(jugador) {
    const rankingDiv = document.getElementById('ranking_final');

    rankingDiv.innerHTML = `
        &lt;h2>游끥 RANKING FINAL 游끥&lt;/h2>
        &lt;img src="${jugador.imagen}" alt="Jugador" width="150">&lt;br>
    `;

    let mensaje = '';
    let lanzarConfetti = false;

    if (jugador.puntos === 0) {
        mensaje = 'Eres un noob';
    } else if (jugador.puntos > 0 &amp;&amp; jugador.puntos &lt; 200) {
        mensaje = 'Eres un jugador normalito';
        lanzarConfetti = true;
    } else if (jugador.puntos >= 200) {
        mensaje = 'Eres un pro';
        lanzarConfetti = true;
    } else {
        mensaje = `Tienes ${jugador.puntos} puntos.`;
    }

    const resultado = document.createElement('p');
    resultado.textContent = `${jugador.nombre}: ${jugador.puntos} puntos - ${mensaje}`;

    rankingDiv.appendChild(resultado);

    if (lanzarConfetti &amp;&amp; window.confetti) {
        confetti({
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 }
        });
    }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Enemigo.html">Enemigo</a></li><li><a href="Jefe.html">Jefe</a></li><li><a href="Objeto_Objeto.html">Objeto</a></li><li><a href="Personaje.html">Personaje</a></li></ul><h3>Global</h3><ul><li><a href="global.html#aplicarDescuento">aplicarDescuento</a></li><li><a href="global.html#batalla">batalla</a></li><li><a href="global.html#batallaJefe">batallaJefe</a></li><li><a href="global.html#buscarProducto">buscarProducto</a></li><li><a href="global.html#deepClone">deepClone</a></li><li><a href="global.html#filtrarPorRareza">filtrarPorRareza</a></li><li><a href="global.html#groupBy">groupBy</a></li><li><a href="global.html#mostrarBatalla">mostrarBatalla</a></li><li><a href="global.html#mostrarFinal">mostrarFinal</a></li><li><a href="global.html#mostrarJugador">mostrarJugador</a></li><li><a href="global.html#mostrarMarket">mostrarMarket</a></li><li><a href="global.html#mostrarProducto">mostrarProducto</a></li><li><a href="global.html#mostrarRanking">mostrarRanking</a></li><li><a href="global.html#mostrarStats">mostrarStats</a></li><li><a href="global.html#objetos">objetos</a></li><li><a href="global.html#showScene">showScene</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Tue Dec 02 2025 17:11:26 GMT+0100 (hora est치ndar de Europa central)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
